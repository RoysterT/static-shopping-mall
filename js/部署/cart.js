function loadCart(){if(0!=localStorage.length){isCartEmpty();for(var i=0;i<localStorage.length;i++){var itemHtml=$("#temp").html(),key=localStorage.key(i),jsonStr=localStorage.getItem(key),json=JSON.parse(jsonStr);itemHtml=(itemHtml=(itemHtml=(itemHtml=(itemHtml=itemHtml.replace("#name#",json.name)).replace("#price#",json.price)).replace("#num#",json.num)).replace("#url#",json.src)).replace("#totalPrice#",priceCount(json.priceNum,json.num)+".00");var cartHtml=document.getElementById("cartContent").innerHTML;cartHtml+=itemHtml,document.getElementById("cartContent").innerHTML=cartHtml}}}function isCartEmpty(){var cartIsEmpty=document.getElementsByClassName("cartIsEmpty")[0];0==localStorage.length?cartIsEmpty.style.display="block":cartIsEmpty.style.display="none"}function priceCount(price,num){return price*num}loadCart();for(var checkBox=document.getElementsByClassName("checkBox"),i=0;i<checkBox.length;i++)checkBox[i].onclick=function(){totalPriceCount()};for(var itemAdd=document.getElementsByClassName("item-add"),i=0;i<itemAdd.length;i++)itemAdd[i].onclick=function add(){var number=this.parentNode.getElementsByClassName("item-number")[0].value,goodsName=this.parentNode.parentNode.getElementsByClassName("item-info-text")[0].innerHTML,goodsPrice=this.parentNode.parentNode.getElementsByClassName("item-price")[0].innerHTML,priceNumber=parseFloat(goodsPrice.substring(1)),goodsSrc=this.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img")[0].src;number++,this.parentNode.getElementsByClassName("item-number")[0].value=number,this.parentNode.parentNode.getElementsByClassName("checkBox")[0].checked=!0,goodsNum=number;var msg={name:goodsName,price:goodsPrice,priceNum:priceNumber,num:goodsNum,src:goodsSrc};localStorage.removeItem(goodsName),localStorage.setItem(goodsName,JSON.stringify(msg)),this.parentNode.parentNode.getElementsByClassName("item-total-price")[0].innerHTML="&yen;"+priceCount(priceNumber,number)+".00",totalPriceCount()};for(var itemSub=document.getElementsByClassName("item-sub"),i=0;i<itemSub.length;i++)itemSub[i].onclick=function add(){var number=this.parentNode.getElementsByClassName("item-number")[0].value;if(number>1){var goodsName=this.parentNode.parentNode.getElementsByClassName("item-info-text")[0].innerHTML,goodsPrice=this.parentNode.parentNode.getElementsByClassName("item-price")[0].innerHTML,priceNumber=parseFloat(goodsPrice.substring(1)),goodsSrc=this.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img")[0].src;number--,this.parentNode.getElementsByClassName("item-number")[0].value=number,this.parentNode.parentNode.getElementsByClassName("checkBox")[0].checked=!0,goodsNum=number;var msg={name:goodsName,price:goodsPrice,priceNum:priceNumber,num:goodsNum,src:goodsSrc};localStorage.removeItem(goodsName),localStorage.setItem(goodsName,JSON.stringify(msg)),this.parentNode.parentNode.getElementsByClassName("item-total-price")[0].innerHTML="&yen;"+priceCount(priceNumber,number)+".00"}else{var flag;if(confirm("是否确认删除商品？")){$(this).parent().parent().remove();var goodsName=this.parentNode.parentNode.getElementsByClassName("item-info-text")[0].innerHTML;localStorage.removeItem(goodsName),isCartEmpty()}}totalPriceCount()};for(var itemInput=document.getElementsByClassName("item-number"),i=0;i<itemInput.length;i++)itemInput[i].oninput=function(){var goodsName=this.parentNode.parentNode.getElementsByClassName("item-info-text")[0].innerHTML,goodsPrice=this.parentNode.parentNode.getElementsByClassName("item-price")[0].innerHTML,priceNumber=parseFloat(goodsPrice.substring(1)),goodsSrc=this.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("img")[0].src;this.parentNode.parentNode.getElementsByClassName("checkBox")[0].checked=!0;var number=this.value,goodsNum,msg={name:goodsName,price:goodsPrice,priceNum:priceNumber,num:number,src:goodsSrc};localStorage.removeItem(goodsName),localStorage.setItem(goodsName,JSON.stringify(msg)),this.parentNode.parentNode.getElementsByClassName("item-total-price")[0].innerHTML="&yen;"+priceCount(priceNumber,number)+".00",totalPriceCount()};function totalPriceCount(){for(var totalAmount=0,totalPrice=0,j=0;j<checkBox.length;j++)checkBox[j].checked&&(totalAmount+=parseInt(checkBox[j].parentNode.parentNode.getElementsByClassName("item-number")[0].value),totalPrice+=parseInt(checkBox[j].parentNode.parentNode.getElementsByClassName("item-total-price")[0].innerHTML.substring(1)));var titlePrice,titleAmount;document.getElementById("titlePrice").innerHTML=totalPrice+".00",document.getElementById("titleAmount").innerHTML=totalAmount}$(".itemWrapper").on("click",".del-btn",(function(){var flag;if(confirm("是否确认删除商品？")){$(this).parent().parent().remove();var goodsName=this.parentNode.parentNode.getElementsByClassName("item-info-text")[0].innerHTML;localStorage.removeItem(goodsName),isCartEmpty()}}));var submitButton=document.getElementById("submitButton");submitButton.onclick=function(){for(var choseNum=0,checkBox=document.getElementsByClassName("checkBox"),i=0;i<checkBox.length;i++)if(1==checkBox[i].checked){choseNum++;var goodsName=checkBox[i].parentNode.parentNode.getElementsByClassName("item-info-text")[0].innerHTML;localStorage.removeItem(goodsName)}choseNum&&(location.href="/success.html")};var clearMyCart=document.getElementById("clearMyCart");clearMyCart.onclick=function(){localStorage.clear(),location.href="/cart.html"};var selectAll=document.getElementsByClassName("select-all")[0],isSelectAll=!1;selectAll.onclick=function(){this.getElementsByClassName("choseAll")[0].checked=!isSelectAll;for(var checkBox=document.getElementsByClassName("checkBox"),i=0;i<checkBox.length;i++)checkBox[i].checked=!isSelectAll;isSelectAll=!isSelectAll,totalPriceCount()};